import{r as e,A as l,a,b as s,w as o,i as t,d as c,e as u,j as n,t as i,v as d,x as r,s as p,h as m,E as f,q as v,p as _,R as h}from"./index-BGdZDLVO.js";import{_ as w}from"./uv-input.CS2zCiHK.js";import{_ as V,r as y}from"./request.RFVXOHA2.js";import{_ as k}from"./uni-icons.aWtZdbs2.js";import{b as g,c as x,d as b,e as Q}from"./index.CzjDnQjI.js";import"./uv-icon.DXxGSX6z.js";const C=V({__name:"login",setup(V){const C=e(0),U=e(!1),I=e(!1),j=l({account:"",password:"",email:""}),z=l({account:"",nickname:"",password:"",code:""}),q=e(null),A=l({code:"",password:"",newPassword:""}),P=async()=>q.value?/^[a-zA-Z0-9_-]+@qq.com$/.test(q.value)?(await g(q.value),void r({title:"邮件已发送5分钟内有效",icon:"success"})):r({title:"请输入正确QQ邮箱",icon:"none"}):r({title:"请输入QQ邮箱",icon:"none"}),S=()=>{U.value=!1,I.value=!1,z.account="",z.nickname="",z.password="",z.code="",A.code="",A.password="",A.newPassword="",q.value=null},E=async()=>{if(0===C.value){if(!j.account||!j.password)return r({title:"请输入账户名称和密码",icon:"none"})}else if(!j.email||!j.password)return r({title:"请输入邮箱和密码",icon:"none"});p({title:"登录中...",mask:!0});const e=await x({loginType:C.value,...j});if(201===e.code)return void r({title:"登录失败",icon:"error"});const l=JSON.parse(e.data.userInfo);localStorage.setItem("h5UserInfo",e.data.userInfo),localStorage.setItem(l.account+"token",e.data.token),localStorage.setItem("role",e.data.role),m(),r({title:"登录成功",duration:2e3}),f({url:"/pages/index/index",success:()=>{}})},Z=e(!1),$=e(!1),D=e(!1),F=async()=>{if(!A.code||!A.password||!A.newPassword||""===q.value)return r({title:"请输入完整信息",icon:"none"});await b({...A,email:q.value}),r({title:"密码重置成功",icon:"success"}),S()},J=async()=>q.value?/^[a-zA-Z0-9_-]+@qq.com$/.test(q.value)?z.account?z.code?(await Q({...z,email:q.value}),r({title:"注册成功",icon:"success"}),void S()):r({title:"请输入验证码",icon:"none"}):r({title:"请输入唯一账户名称",icon:"none"}):r({title:"请输入正确QQ邮箱",icon:"none"}):r({title:"请输入QQ邮箱",icon:"none"});return(e,l)=>{const r=t,p=v,m=_,f=y(a("uv-input"),w),V=y(a("uni-icons"),k),g=h;return c(),s(r,{class:"login-content"},{default:o((()=>[u(r,{class:"bg-animation"},{default:o((()=>[u(r,{class:"circle"}),u(r,{class:"circle"})])),_:1}),u(r,{class:"content-box"},{default:o((()=>[u(r,{class:"logo-area"},{default:o((()=>[u(p,{src:"/assets/logo-lDza_cjE.png",mode:"aspectFit",class:"logo-img"}),u(m,{class:"slogan"},{default:o((()=>[n("AI陪你刷题，刷题不枯燥")])),_:1})])),_:1}),u(r,{class:"input-box"},{default:o((()=>[0===C.value?(c(),s(f,{key:0,class:"input",shape:"circle",placeholder:"请输入账户名称",modelValue:j.account,"onUpdate:modelValue":l[0]||(l[0]=e=>j.account=e)},null,8,["modelValue"])):(c(),s(f,{key:1,class:"input",shape:"circle",placeholder:"请输入QQ邮箱",modelValue:j.email,"onUpdate:modelValue":l[1]||(l[1]=e=>j.email=e)},null,8,["modelValue"])),u(f,{class:"input",type:D.value?"text":"password",shape:"circle",placeholder:"请输入密码",modelValue:j.password,"onUpdate:modelValue":l[3]||(l[3]=e=>j.password=e)},{suffix:o((()=>[u(V,{type:D.value?"eye-filled":"eye-slash-filled",size:"20",color:"#999",onClick:l[2]||(l[2]=e=>D.value=!D.value)},null,8,["type"])])),_:1},8,["type","modelValue"]),u(g,{onClick:E,class:"login-btn","hover-class":"btn-hover"},{default:o((()=>[n("开始刷题")])),_:1}),u(r,{class:"action-row"},{default:o((()=>[u(m,{onClick:l[4]||(l[4]=e=>(I.value=!0,j.account="",j.email="",void(j.password="")))},{default:o((()=>[n("忘记密码")])),_:1}),u(m,{onClick:l[5]||(l[5]=e=>(j.account="",j.email="",j.password="",void(C.value=0===C.value?1:0)))},{default:o((()=>[n(i(0===C.value?"QQ邮箱登录":"账户登录"),1)])),_:1})])),_:1})])),_:1}),U.value?(c(),s(r,{key:0,class:"register-form"},{default:o((()=>[u(r,{class:"form-title"},{default:o((()=>[u(m,{class:"title"},{default:o((()=>[n("加入AI刷题")])),_:1}),u(m,{class:"back",onClick:S},{default:o((()=>[n("返回登录")])),_:1})])),_:1}),u(r,{class:"input-group"},{default:o((()=>[u(f,{class:"input",maxlength:"8",shape:"circle",placeholder:"创建你的专属账户 (注册后不可更改)",modelValue:z.account,"onUpdate:modelValue":l[6]||(l[6]=e=>z.account=e)},null,8,["modelValue"]),u(f,{class:"input",maxlength:"8",shape:"circle",placeholder:"给自己起个独特的昵称",modelValue:z.nickname,"onUpdate:modelValue":l[7]||(l[7]=e=>z.nickname=e)},null,8,["modelValue"]),u(f,{class:"input",shape:"circle",placeholder:"请输入QQ邮箱",modelValue:q.value,"onUpdate:modelValue":l[9]||(l[9]=e=>q.value=e)},{suffix:o((()=>[u(m,{onClick:l[8]||(l[8]=e=>P())},{default:o((()=>[n(" 发送验证码")])),_:1})])),_:1},8,["modelValue"]),u(f,{class:"input",shape:"circle",placeholder:"请输入验证码",modelValue:z.code,"onUpdate:modelValue":l[10]||(l[10]=e=>z.code=e),maxlength:"6"},null,8,["modelValue"]),u(f,{class:"input",type:Z.value?"text":"password",shape:"circle",placeholder:"请输入登录密码",modelValue:z.password,"onUpdate:modelValue":l[12]||(l[12]=e=>z.password=e)},{suffix:o((()=>[u(V,{type:Z.value?"eye-filled":"eye-slash-filled",size:"20",color:"#999",onClick:l[11]||(l[11]=e=>Z.value=!Z.value)},null,8,["type"])])),_:1},8,["type","modelValue"])])),_:1}),u(g,{class:"register-submit-btn","hover-class":"btn-hover",onClick:J},{default:o((()=>[n("开启AI刷题之旅")])),_:1})])),_:1})):d("",!0),I.value?(c(),s(r,{key:1,class:"forget-form"},{default:o((()=>[u(r,{class:"form-title"},{default:o((()=>[u(m,{class:"title"},{default:o((()=>[n("重置密码")])),_:1}),u(m,{class:"back",onClick:S},{default:o((()=>[n("返回登录")])),_:1})])),_:1}),u(r,{class:"input-group"},{default:o((()=>[u(f,{class:"input",shape:"circle",placeholder:"请输入QQ邮箱",modelValue:q.value,"onUpdate:modelValue":l[14]||(l[14]=e=>q.value=e)},{suffix:o((()=>[u(m,{onClick:l[13]||(l[13]=e=>P())},{default:o((()=>[n(" 发送验证码 ")])),_:1})])),_:1},8,["modelValue"]),u(f,{class:"input",shape:"circle",placeholder:"请输入验证码",modelValue:A.code,"onUpdate:modelValue":l[15]||(l[15]=e=>A.code=e),maxlength:"6"},null,8,["modelValue"]),u(f,{class:"input",type:Z.value?"text":"password",shape:"circle",placeholder:"请输入新密码",modelValue:A.password,"onUpdate:modelValue":l[17]||(l[17]=e=>A.password=e)},{suffix:o((()=>[u(V,{type:Z.value?"eye-filled":"eye-slash-filled",size:"20",color:"#999",onClick:l[16]||(l[16]=e=>Z.value=!Z.value)},null,8,["type"])])),_:1},8,["type","modelValue"]),u(f,{class:"input",type:$.value?"text":"password",shape:"circle",placeholder:"请确认新密码",modelValue:A.newPassword,"onUpdate:modelValue":l[19]||(l[19]=e=>A.newPassword=e)},{suffix:o((()=>[u(V,{type:$.value?"eye-filled":"eye-slash-filled",size:"20",color:"#999",onClick:l[18]||(l[18]=e=>$.value=!$.value)},null,8,["type"])])),_:1},8,["type","modelValue"])])),_:1}),u(g,{class:"forget-submit-btn","hover-class":"btn-hover",onClick:F},{default:o((()=>[n("确认修改")])),_:1})])),_:1})):d("",!0),u(r,{class:"register-box"},{default:o((()=>[u(m,null,{default:o((()=>[n("还没有刷题过？")])),_:1}),u(m,{class:"register-btn",onClick:l[20]||(l[20]=e=>U.value=!0)},{default:o((()=>[n("立即注册")])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-0a3777f9"]]);export{C as default};
